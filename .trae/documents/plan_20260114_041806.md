# 修改"下载法相"功能，包含祝福语和日期

## 问题分析

1. **当前状态**：

   * "下载法相"功能只能下载纯图片，不包含预览中的祝福语和日期

   * 预览中的祝福语和日期是通过CSS绝对定位叠加在图片上的

   * 下载功能使用Canvas API直接绘制图片，没有处理文字覆盖

2. **需求**：

   * 下载的法相图片中需要显示预览的佛学祝福句子

   * 下载的法相图片中需要显示下载日期

   * 文字样式和位置需要与预览一致

   * 不修改其他元素

## 修复方案

修改`handleDownload`函数的直接下载模式，在Canvas绘制图片后，叠加绘制祝福语和日期：

1. **获取当前显示的文字内容**：

   * 当前祝福语：`currentEnglishQuote`和`currentQuote`

   * 当前日期：`getEnglishDate(new Date())`和`convertDateToAncientFormat(new Date())`

2. **在Canvas上绘制文字**：

   * 顶部绘制祝福语：英文在上，中文在下

   * 底部绘制日期：英文在上，中文在下

   * 使用与CSS一致的字体、大小、颜色和阴影效果

   * 保持与预览相同的位置和布局

3. **保持原有的下载逻辑**：

   * 不改变文件命名和下载流程

   * 保持Canvas合成模式的原有功能

## 具体修改步骤

1. **修改`handleDownload`函数的直接下载模式**（第371-428行）：

   * 在绘制图片后，添加文字绘制逻辑

   * 绘制顶部祝福语

   * 绘制底部日期

   * 使用与CSS一致的样式

2. **使用CSS中定义的样式参数**：

   * 英文祝福语：1.1rem，Noto Sans字体，白色，带阴影

   * 中文祝福语：1.4rem，Noto Serif SC字体，白色，带阴影

   * 英文日期：1.0rem，Noto Sans字体，白色，带阴影

   * 中文日期：1.2rem，Noto Serif SC字体，白色，带阴影

   * 文字居中对齐

3. **确保文字位置正确**：

   * 祝福语位于图片顶部，居中对齐

   * 日期位于图片底部，居中对齐

   * 添加适当的边距

## 预期效果

* 下载的法相图片包含完整的祝福语和日期

* 文字样式和位置与预览一致

* "下载法相"功能正常工作

* 不影响其他功能

