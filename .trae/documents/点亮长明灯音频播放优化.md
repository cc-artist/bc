# 点亮长明灯音频播放优化计划

## 问题分析
1. 音频文件存在但检查脚本显示时长为0.00秒
2. 长明灯音频播放逻辑已存在但可能需要优化
3. 浏览器自动播放策略可能影响音频播放
4. 需要确保音频清晰响亮且在10秒以内

## 解决方案

### 1. 重新生成音频文件
- 使用 `generate-audio.js` 脚本重新生成符合要求的10秒佛教音频
- 确保音频格式正确，使用WAV格式以保证兼容性
- 优化音频生成参数，确保音频清晰响亮

### 2. 优化音频检查脚本
- 修复 `check-audio-duration.js` 脚本，确保能正确检测音频时长
- 添加更详细的音频文件信息输出

### 3. 增强音频播放逻辑
- 在长明灯状态从 `unlit` 切换到 `lighting` 时确保音频播放
- 优化音频播放的错误处理机制
- 添加用户交互触发机制，避免浏览器自动播放限制
- 增强Web Audio API备用方案，确保在音频文件加载失败时能播放替代音频

### 4. 优化音频加载体验
- 添加音频预加载机制
- 优化音频播放的音量控制，确保清晰响亮
- 添加音频播放状态反馈

## 实施步骤

1. **重新生成音频文件**
   - 运行 `generate-audio.js` 脚本重新生成音频
   - 使用修复后的 `check-audio-duration.js` 验证音频时长

2. **优化长明灯音频播放逻辑**
   - 增强 `page.tsx` 中的音频播放代码
   - 优化 `generateBuddhistSound` 函数，确保备用音频质量
   - 添加用户交互触发音频播放的机制

3. **测试音频播放功能**
   - 启动前后端服务
   - 测试长明灯点亮时的音频播放
   - 验证音频加载失败时的备用方案

4. **优化音频加载体验**
   - 添加音频预加载配置
   - 优化音量控制逻辑
   - 添加音频播放状态反馈

## 预期结果
- 点亮长明灯时能成功播放10秒以内的清晰响亮佛教音频
- 音频加载失败时有可靠的备用方案
- 浏览器自动播放限制不影响音频播放
- 音频播放体验流畅自然

这个计划将确保点亮长明灯时能成功播放符合要求的音频，解决音频加载失败的问题。